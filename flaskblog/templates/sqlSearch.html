{% extends "layout.html" %}
{% block content %}
<div class="content-section">
    <form method="POST" action="">
        {{ form.hidden_tag() }}
        <fieldset class="form-group">
            <div class="form-group">
                {{ form.market_cap_field.label(class="form-control-label") }}
                {% if form.market_cap_field.errors %}
                    {{ form.market_cap_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.market_cap_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.market_cap_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.sma_field.label(class="form-control-label") }}
                {% if form.sma_field.errors %}
                    {{ form.sma_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.sma_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.sma_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.ps_field.label(class="form-control-label") }}
                {% if form.ps_field.errors %}
                    {{ form.ps_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.ps_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.ps_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.gross_margin_field.label(class="form-control-label") }}
                {% if form.gross_margin_field.errors %}
                    {{ form.gross_margin_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.gross_margin_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.gross_margin_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.operating_margin_field.label(class="form-control-label") }}
                {% if form.operating_margin_field.errors %}
                    {{ form.operating_margin_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.operating_margin_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.operating_margin_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
            <div class="form-group">
                {{ form.profit_margin_field.label(class="form-control-label") }}
                {% if form.profit_margin_field.errors %}
                    {{ form.profit_margin_field(class="form-control form-control-lg is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in form.profit_margin_field.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.profit_margin_field(class="form-control form-control-md") }}
                {% endif %}
            </div>
        </fieldset>
        <div class="form-group">
            {{ form.submit(class="btn btn-outline-info") }}
        </div>
    </form>
</div>
<div class="content-section">
    <h2>Search Results</h2>
    <table id="sortableTable" class="table table-striped table-hover">
        <thead>
            <tr>
                <th onclick="sortTable(0)">#</th>
                <th onclick="sortTable(1)">Symbol</th>
                <th onclick="sortTable(2)">Market Cap</th>
                <th onclick="sortTable(3)">Price Minus SMA</th>
                <th onclick="sortTable(4)">Price to Sales</th>
                <th onclick="sortTable(5)">Gross Margin</th>
                <th onclick="sortTable(6)">Profit Margin</th>
                <th onclick="sortTable(7)">Operating Margin</th>
            </tr>
        </thead>
        <tbody>
            {% for stock in searchResults %}
                <tr>
                    <td>{{loop.index}}</td>
                    <td>{{stock.symbol}}</td>
                    <td>{{stock.market_cap}}</td>
                    <td>{{stock.sma200}}</td>
                    <td>{{stock.ps}}</td>
                    <td>{{stock.gross_margin}}</td>
                    <td>{{stock.profit_margin}}</td>
                    <td>{{stock.operating_margin}}</td>                    
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock content %}
